[
  {
    "context": "Health endpoint - anonymous allowed",
    "token": null,
    "method": "GET",
    "endpoint": "http://localhost:6004/health",
    "shouldMatch": "expected/expectedHealthEndpoint.json",
    "expectedStatus": 200
  },
  {
    "context": "POST viewer descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/viewer_descriptor.json",
    "shouldMatch": "postBody/viewer_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "POST regex descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/regex_descriptor.json",
    "shouldMatch": "postBody/regex_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "POST regex descriptor 2 - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/regex_descriptor2.json",
    "shouldMatch": "postBody/regex_descriptor2.json",
    "expectedStatus": 201
  },
  {
    "context": "POST public descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/public_descriptor.json",
    "shouldMatch": "postBody/public_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "GET viewer descriptor - viewer allowed via $starts-with",
    "token": { "user": "usera", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczp2aWV3ZXItYXNzZXQ",
    "shouldMatch": "postBody/viewer_descriptor.json",
    "expectedStatus": 200
  },
  {
    "context": "GET viewer descriptor - editor denied (prefix rule)",
    "token": { "user": "userx", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczp2aWV3ZXItYXNzZXQ",
    "expectedStatus": 403
  },
  {
    "context": "GET regex descriptor - editor allowed via $regex",
    "token": { "user": "userx", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczpyZWdleC00Mg",
    "shouldMatch": "postBody/regex_descriptor.json",
    "expectedStatus": 200
  },
  {
    "context": "GET regex descriptor - editor denied (regex rule not matched)",
    "token": { "user": "userx", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczpyZWdpbWF4LTQy",
    "expectedStatus": 403
  },
  {
    "context": "GET public descriptor - anonymous allowed via $ends-with",
    "token": null,
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczpkZW1vOnB1YmxpYw",
    "shouldMatch": "postBody/public_descriptor.json",
    "expectedStatus": 200
  },
  {
    "context": "GET viewer descriptor - anonymous denied",
    "token": null,
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczp2aWV3ZXItYXNzZXQ",
    "expectedStatus": 403
  },
  {
    "context": "GET all descriptor - editor ",
    "token": { "user": "userx", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "shouldMatch": "expected/expectedEditorResult.json",
    "expectedStatus": 200
  },
  {
    "context": "GET all descriptor - viewer ",
    "token": { "user": "usera", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "shouldMatch": "expected/expectedViewerResult.json",
    "expectedStatus": 200
  },
  {
    "context": "GET all descriptor - anon ",
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "shouldMatch": "expected/expectedAnonResult.json",
    "expectedStatus": 200
  },
  {
    "context": "POST time allow descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/time_allow_descriptor.json",
    "shouldMatch": "postBody/time_allow_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "POST time deny descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/time_deny_descriptor.json",
    "shouldMatch": "postBody/time_deny_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "GET time allow descriptor - viewer allowed via datetime compare",
    "token": { "user": "userb", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczp0aW1lLWFsbG93",
    "shouldMatch": "postBody/time_allow_descriptor.json",
    "expectedStatus": 200
  },
  {
    "context": "GET time deny descriptor - viewer denied via datetime compare",
    "token": { "user": "userb", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczp0aW1lLWRlbnk=",
    "expectedStatus": 403
  },
  {
    "context": "POST time field allow descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/time_field_allow_descriptor.json",
    "shouldMatch": "postBody/time_field_allow_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "POST time field deny descriptor - admin creates fixture",
    "token": { "user": "admin", "password": "pwd" },
    "method": "POST",
    "endpoint": "http://localhost:6004/shell-descriptors",
    "data": "postBody/time_field_deny_descriptor.json",
    "shouldMatch": "postBody/time_field_deny_descriptor.json",
    "expectedStatus": 201
  },
  {
    "context": "GET time field allow descriptor - viewer allowed via field datetime compare",
    "token": { "user": "userb", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczpkdC1maWVsZC1hbGxvdw",
    "shouldMatch": "postBody/time_field_allow_descriptor.json",
    "expectedStatus": 200
  },
  {
    "context": "GET time field deny descriptor - viewer denied via field datetime compare",
    "token": { "user": "userb", "password": "pwd" },
    "method": "GET",
    "endpoint": "http://localhost:6004/shell-descriptors/dXJuOmFhczpkdC1maWVsZC1kZW55",
    "expectedStatus": 403
  }
]
