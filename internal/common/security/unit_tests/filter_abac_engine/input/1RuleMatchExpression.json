{
  "AllAccessPermissionRules": {
    "DEFATTRIBUTES": [
      { "name": "role_attr", "attributes": [ { "CLAIM": "role" } ] }
    ],
    "DEFOBJECTS": [
      { "name": "all_shell_descriptors", "objects": [ { "DESCRIPTOR": "$aasdesc(\"*\")" } ] }
    ],
    "DEFACLS": [
      { "name": "user", "acl": { "USEATTRIBUTES": "role_attr", "RIGHTS": [ "READ" ], "ACCESS": "ALLOW" } }
    ],
    "DEFFORMULAS": [
      {
        "name": "role_match_in_descriptor",
        "formula": {
          "$match": [
            {
              "$eq": [
                { "$field": "$aasdesc#specificAssetIds[].externalSubjectId.keys[].value" },
                { "$attribute": { "CLAIM": "role" } }
              ]
            }
          ]
        }
      }
    ],
    "rules": [
      { "USEACL": "user", "USEOBJECTS": [ "all_shell_descriptors" ], "USEFORMULA": "role_match_in_descriptor" }
    ]
  }
}
