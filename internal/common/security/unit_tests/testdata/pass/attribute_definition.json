{
  "AllAccessPermissionRules": {
    "DEFFORMULAS": [
      {
        "name": "f1",
        "formula": {
          "$or":[
            {
              "$and": [
              { "$ge": [ { "$numCast": { "$attribute": { "CLAIM": "clear" } } }, { "$numVal": 5 } ] },

              { "$ge": [
                { "$timeCast": { "$attribute": { "GLOBAL": "LOCALNOW" } } },
                { "$timeVal": "16:40" }
              ]},
              { "$le": [
                { "$timeCast": { "$attribute": { "GLOBAL": "LOCALNOW" } } },
                { "$timeVal": "08:00" }
              ]}
            ]
            },
            { "$eq": [ { "$attribute": { "CLAIM": "role" } }, { "$strVal": "viewer" } ] }
          ]
        }
      }
    ],
    "DEFOBJECTS": [
      { 
        "name": "lookupshell",
        "objects": [
          { "ROUTE": "/lookup/shells/*" }
        ]
      }
    ],
    "DEFACLS": [
      {
        "name": "read_acl",
        "acl": {
          "USEATTRIBUTES": "is_member",
          "RIGHTS": [ "READ" ],
          "ACCESS": "ALLOW"
        }
      }
    ],
    "DEFATTRIBUTES": [
      {
        "name": "has_role",
        "attributes": [
          {"CLAIM": "role"}
        ]
      },
      {
        "name": "has_clearance",
        "attributes": [
          {"CLAIM": "clear"}
        ]
      },
      {
        "name": "is_member",
        "attributes": [
          {"CLAIM": "clear"},
          {"CLAIM": "role"}
        ]
      },
      {
        "name": "anonym",
        "attributes": [
          {"GLOBAL": "ANONYMOUS"}
        ]
      }
    ],
    "rules": [
      {
        "USEACL": "read_acl",
        "USEOBJECTS": ["lookupshell"],
        "USEFORMULA": "f1"
      },
      {
        "ACL": {
          "ATTRIBUTES": [
            { "CLAIM": "role" },
            { "CLAIM": "clear" }
          ],
          "RIGHTS": [ "CREATE" ],
          "ACCESS": "ALLOW"
        },
        "OBJECTS": [
          { "ROUTE": "/lookup/shells/*" }
        ],
        "FORMULA": 
          { "$eq": [ { "$attribute": { "CLAIM": "role" } }, { "$strVal": "editor" } ] }
      }
    ]
  }
}
